---
title: 授权测试记录-虚拟机
tags:
  - 记录
categories:
  - 技术/软件
date: 2025-06-02 16:03:20
author: 陈小可
excerpt: 一些安全厂商的授权信息测试记录，仅供学习使用
---

> 仅供学习使用
> 
> 本教程仅用于个人学习和技术交流，不构成任何商业推荐或投资建议。教程中涉及的工具、软件或服务仅供参考，作者不对其实际效果、安全性或合法性做任何保证。
> 
> 请用户根据自身情况审慎判断，并自行承担使用本教程及其中提到的任何工具、软件或服务可能带来的风险（包括但不限于数据丢失、系统损坏、法律纠纷等）。
> 
> 本教程文字内容由作者[开心ucu]创作，版权归属作者本人。
> 
> 严禁转载，如果转载造成的任何问题，后果请自行承担
> 
> 快照是个好东西，建议合理使用，这些镜像等情况都能通过快照形式接着用，无非是有些会掉用ntp或定时同步系统时间
> 实现了授权到期的情况，虚拟机运行时将同步系统时间关闭，不联网（无法连接到ntp服务器）等操作，可实现一直用

# 网御星云
## 漏扫
> 系统为ova格式，使用Vmware安装，会发现，将此虚拟机换到另一台电脑运行时，授权码会出现变化。
>> 使用Vmware的cpuID模拟，模拟cpuID和cpu型号可以跳过校验,实现“通用”

如果觉得麻烦，直接使用快照即可，关闭Vmware设置的时间同步功能等，做完的时候使用快照，需要用到的时候恢复快照，或挂起。

### 查看cpuID和型号
下载一个ubuntu的镜像文件（Desktop），用Try模式，在安装界面这里不安装，打开终端，使用如下命令查看cpu型号(`lscpu`也能看)
```shell
cat /proc/cpuinfo
```
返回如下数据
```text
# cat /proc/cpuinfo 
processor       : 0
vendor_id       : GenuineIntel
cpu family      : 6
model           : 79
model name      : Intel(R) Xeon(R) CPU E5-2660 v4 @ 2.00GHz
stepping        : 1
microcode       : 0xb00003a
cpu MHz         : 1995.500
cache size      : 35840 KB
physical id     : 0
siblings        : 28
core id         : 3
cpu cores       : 14
apicid          : 6
initial apicid  : 6
fpu             : yes
fpu_exception   : yes
cpuid level     : 20
wp              : yes
flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 cdp_l3 pti intel_ppin ssbd ibrs ibpb stibp tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 hle avx2 smep bmi2 erms invpcid rtm cqm rdt_a rdseed adx smap intel_pt xsaveopt cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local dtherm arat pln pts vnmi md_clear flush_l1d
vmx flags       : vnmi preemption_timer posted_intr invvpid ept_x_only ept_ad ept_1gb flexpriority apicv tsc_offset vtpr mtf vapic ept vpid unrestricted_guest vapic_reg vid ple shadow_vmcs pml
bugs            : cpu_meltdown spectre_v1 spectre_v2 spec_store_bypass l1tf mds swapgs taa itlb_multihit mmio_stale_data
bogomips        : 3991.00
clflush size    : 64
cache_alignment : 64
address sizes   : 46 bits physical, 48 bits virtual
power management:
```
其中cpu型号为model name数据：`Intel(R) Xeon(R) CPU E5-2660 v4 @ 2.00GHz`

查看cpuID如下
```shell
dmidecode -t 4 | grep ID | sort -u | awk -F': ' '{print $2}'
```
丰富点的如下
```shell
dmidecode -t 4 
```
执行结果如下
```text
root@hcss-ecs-6975:~#  dmidecode -t 4 
# dmidecode 3.4
Getting SMBIOS data from sysfs.
SMBIOS 2.8 present.

Handle 0x0400, DMI type 4, 42 bytes
Processor Information
        Socket Designation: CPU 0
        Type: Central Processor
        Family: Other
        Manufacturer: QEMU
        ID: 57 06 05 00 FF FB 8B 0F
        Version: pc-i440fx-2.8
        Voltage: Unknown
        External Clock: Unknown
        Max Speed: 2000 MHz
        Current Speed: 2000 MHz
        Status: Populated, Enabled
        Upgrade: Other
        L1 Cache Handle: Not Provided
        L2 Cache Handle: Not Provided
        L3 Cache Handle: Not Provided
        Serial Number: Not Specified
        Asset Tag: Not Specified
        Part Number: Not Specified
        Core Count: 1
        Core Enabled: 1
        Thread Count: 2
        Characteristics: None

root@hcss-ecs-6975:~# 
```
其中cpuID为`57 06 05 00 FF FB 8B 0F`

修改vmware的信息参考这个地址：[https://luotianyi.vc/8375.html](https://luotianyi.vc/8375.html)

### 进底层
有个挑战码，这个可以直接拨打400拿到进底层
> 我找到个0day，可以通过这个0day直接进底层，暂不公开

### 授权时间
经测试，过去后，修改时间为授权时间范围内，可以正常使用
> 进底层，将ntp相关服务删了，同时更改系统时间为授权时间范围
> 
> 然后呢，基线等正常，包括xxx都正常的

## EDR
### 安装，使用openEuler进行安装
安装过程中，可以通过ps -aux查看进程得到***的密码
解包后可进行内容分析

当然了，EDR装好后也可以直接登录系统openEuler看的。

能够定位到使用了tomcat，且调用了war包，通过逆向war包，测试，能够拿到xxx的逻辑

其中，java中调用了so文件来解密授权文件，逆向so文件（C#）按照这个逻辑，弄到授权的加密逻辑，可根据逻辑编写加密及解密的方法实现自己开授权

经测试xx后正常，且xx等都能实现。

# 安恒信息
## 漏洞扫描
### 快照
### 改Vmware模拟cpuid等
和网御星云的楼扫一样，实际上嘛，用不用这个方法无所谓，多的不好描述

# 深信服
## AF（下一代防火墙）
和上面的方法接近，我用PVE，使用备份形式能够实现多设备同网关，然后再申请一个测试授权。

经测试，同一镜像文件下8095、8075，如果管理网口(第一个网口)的MAC地址一样，则网关ID一样。

授权相关验证程序拿到，但没时间做逆向分析，且存在大量的so库调用。

具体过程不便透露

## AC（上网/全网 行为管理系统）
同AF


---

未完待续
